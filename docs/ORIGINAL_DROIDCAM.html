
<!doctype html>
<html>
<head>
	<meta charset="utf-8">
	<link rel="stylesheet" href="assets/bootstrap-4.5.3.min.css">
	<title>DroidCam Remote</title>
	<style type="text/css">
	body {
		color: white;
		padding: 8px;
		background-color: #1b1b1b;
	}
	.modal {
		color: black;
	}
	a {
		color: #00c4ff;
	}
	svg.bi-lock, svg.bi-unlock {
		vertical-align: text-top;
	}
	.overlay {
		width: 100%;
		height: 100%;
		top: 0; left: 0; right: 0; bottom: 0;
		padding: 5% 0% 5% 0%;
		display: none;
		position: absolute;
		text-align: center;
		z-index: 9;
		opacity: 0.9;
		color: white;
		background-color: #1b1b1b;
	}
	.overlay.options {
		padding: 5% 25% 0% 25%;
		opacity: 0.9;
	}
	.range-control {
		transform: rotate(270deg);
		-webkit-transform: rotate(270deg);
		-ms-transform: rotate(270deg);
		height: 200px;
	}
	.col-c {
		padding-left: 20px;
		position: relative;
	}
	.range-cell {
		display: none;
		position: relative;
		-webkit-user-select: none;
		-moz-user-select: none;
		user-select: none;
	}
	.form-check-label {
		position: absolute;
		bottom: -1px;
	}
	.range-close-x {
		position: absolute;
		top: -10px; right: -10px;
	}
	input[type="number"] {
		-moz-appearance: textfield;
		min-width: 3em;
		border: solid 1px;
		outline: 0;
		box-shadow: none;
		background-color: #f0f0f0;
		margin: 0 2px 0 2px;
		padding: 0 2px 0 2px;
	}
	input::-webkit-outer-spin-button,
	input::-webkit-inner-spin-button {
		-webkit-appearance: none;
		margin: 0;
	}
	</style>
</head>
<body>
		<div id="overlay-get-pro" class="overlay">
			<svg width="2em" height="2em" viewBox="0 0 16 16" class="bi bi-star-fill" fill="#EFAC48" xmlns="http://www.w3.org/2000/svg">
			  <path d="M3.612 15.443c-.386.198-.824-.149-.746-.592l.83-4.73L.173 6.765c-.329-.314-.158-.888.283-.95l4.898-.696L7.538.792c.197-.39.73-.39.927 0l2.184 4.327 4.898.696c.441.062.612.636.283.95l-3.523 3.356.83 4.73c.078.443-.36.79-.746.592L8 13.187l-4.389 2.256z"/>
			</svg>
			<br><span locale-tag="get_pro_remote">Get Pro for remote control</span>
			<sup><a href="https://droidcam.app/help/#remote" target="_blank">?</a></sup>
		</div>
		<div id="overlay-stopped" class="overlay">
			<a href="#" onclick="put('/v1/restart'); do_reload(1000); return false;">
				<svg width="4em" height="4em" viewBox="0 0 16 16" class="bi bi-arrow-counterclockwise" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
				  <path fill-rule="evenodd" d="M8 3a5 5 0 1 1-4.546 2.914.5.5 0 0 0-.908-.417A6 6 0 1 0 8 2v1z"/>
				  <path d="M8 4.466V.534a.25.25 0 0 0-.41-.192L5.23 2.308a.25.25 0 0 0 0 .384l2.36 1.966A.25.25 0 0 0 8 4.466z"/>
				</svg>
			</a>
			<br><span locale-tag="app_stopped">Stopped</span>
		</div>
		<div id="overlay-offline" class="overlay">
			<svg width="4em" height="4em" viewBox="0 0 16 16" class="bi bi-camera-video-off-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
				<path fill-rule="evenodd" d="M10.961 12.365a1.99 1.99 0 0 0 .522-1.103l3.11 1.382A1 1 0 0 0 16 11.731V4.269a1 1 0 0 0-1.406-.913l-3.111 1.382A2 2 0 0 0 9.5 3H4.272l6.69 9.365zm-10.114-9A2.001 2.001 0 0 0 0 5v6a2 2 0 0 0 2 2h5.728L.847 3.366zm9.746 11.925l-10-14 .814-.58 10 14-.814.58z"/>
			</svg>
			<br><span locale-tag="video_inactive">Video Inactive</span>&nbsp;<sup><a href="#" onclick="video_inactive_info(); return false;">?</a></sup>
			<br><a href="#" onclick="do_reload(0); return false;">
				<svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-arrow-counterclockwise" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
				  <path fill-rule="evenodd" d="M8 3a5 5 0 1 1-4.546 2.914.5.5 0 0 0-.908-.417A6 6 0 1 0 8 2v1z"/>
				  <path d="M8 4.466V.534a.25.25 0 0 0-.41-.192L5.23 2.308a.25.25 0 0 0 0 .384l2.36 1.966A.25.25 0 0 0 8 4.466z"/>
				</svg>
			</a>&nbsp;(Ctrl+R/cmd+R)
		</div>
		<div id="overlay-loading" class="overlay">
			<span class="spinner-border spinner-border-sm">
				<span class="sr-only">&nbsp;</span>
			</span>
			Loading&hellip;
		</div>
		<h6>
		<a href="#" onclick="options.show(); return false;" title="Options">
			<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-gear">
			  <path d="M8 4.754a3.246 3.246 0 1 0 0 6.492 3.246 3.246 0 0 0 0-6.492zM5.754 8a2.246 2.246 0 1 1 4.492 0 2.246 2.246 0 0 1-4.492 0z"/>
			  <path d="M9.796 1.343c-.527-1.79-3.065-1.79-3.592 0l-.094.319a.873.873 0 0 1-1.255.52l-.292-.16c-1.64-.892-3.433.902-2.54 2.541l.159.292a.873.873 0 0 1-.52 1.255l-.319.094c-1.79.527-1.79 3.065 0 3.592l.319.094a.873.873 0 0 1 .52 1.255l-.16.292c-.892 1.64.901 3.434 2.541 2.54l.292-.159a.873.873 0 0 1 1.255.52l.094.319c.527 1.79 3.065 1.79 3.592 0l.094-.319a.873.873 0 0 1 1.255-.52l.292.16c1.64.893 3.434-.902 2.54-2.541l-.159-.292a.873.873 0 0 1 .52-1.255l.319-.094c1.79-.527 1.79-3.065 0-3.592l-.319-.094a.873.873 0 0 1-.52-1.255l.16-.292c.893-1.64-.902-3.433-2.541-2.54l-.292.159a.873.873 0 0 1-1.255-.52l-.094-.319zm-2.633.283c.246-.835 1.428-.835 1.674 0l.094.319a1.873 1.873 0 0 0 2.693 1.115l.291-.16c.764-.415 1.6.42 1.184 1.185l-.159.292a1.873 1.873 0 0 0 1.116 2.692l.318.094c.835.246.835 1.428 0 1.674l-.319.094a1.873 1.873 0 0 0-1.115 2.693l.16.291c.415.764-.42 1.6-1.185 1.184l-.291-.159a1.873 1.873 0 0 0-2.693 1.116l-.094.318c-.246.835-1.428.835-1.674 0l-.094-.319a1.873 1.873 0 0 0-2.692-1.115l-.292.16c-.764.415-1.6-.42-1.184-1.185l.159-.291A1.873 1.873 0 0 0 1.945 8.93l-.319-.094c-.835-.246-.835-1.428 0-1.674l.319-.094A1.873 1.873 0 0 0 3.06 4.377l-.16-.292c-.415-.764.42-1.6 1.185-1.184l.292.159a1.873 1.873 0 0 0 2.692-1.115l.094-.319z"/>
			</svg>
		</a>
		<span id="title">DroidCam
		</span>
		<span id="battery_info" class="badge">
			<svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-battery-full" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M12 5H2a1 1 0 0 0-1 1v4a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1V6a1 1 0 0 0-1-1zM2 4a2 2 0 0 0-2 2v4a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2H2z"/><path d="M2 6h10v4H2V6zm12.5 3.5a1.5 1.5 0 0 0 0-3v3z"/>
			</svg>
			<span id="battery_value"></span>
		</span>
		<span id="loading_ico" class="spinner-border spinner-border-sm">
			<span class="sr-only">Loading...</span>
		</span>
		</h6>
		<div id="overlay-options" class="overlay options">
			<a href="#" onclick="$(this.parentNode).hide(); return false;" title="Close" locale-tag-title="close">
			<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-x-lg" viewBox="0 0 16 16">
			  <path d="M1.293 1.293a1 1 0 0 1 1.414 0L8 6.586l5.293-5.293a1 1 0 1 1 1.414 1.414L9.414 8l5.293 5.293a1 1 0 0 1-1.414 1.414L8 9.414l-5.293 5.293a1 1 0 0 1-1.414-1.414L6.586 8 1.293 2.707a1 1 0 0 1 0-1.414z"/>
			</svg></a>
			<table id="options_table">
				<tr key="cameraNo_Btn"><td><input type="checkbox" /></td>
					<td>
					<svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-camera-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M10.5 8.5a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0z"/><path fill-rule="evenodd" d="M2 4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2h-1.172a2 2 0 0 1-1.414-.586l-.828-.828A2 2 0 0 0 9.172 2H6.828a2 2 0 0 0-1.414.586l-.828.828A2 2 0 0 1 3.172 4H2zm.5 2a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1zm9 2.5a3.5 3.5 0 1 1-7 0 3.5 3.5 0 0 1 7 0z"/></svg>
					</td>
				</tr>
				<tr key="mic_Btn"><td><input type="checkbox" /></td>
					<td>
						<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-mic-mute-fill" viewBox="0 0 16 16">
						  <path fill-rule="evenodd" d="M12.734 9.613A4.995 4.995 0 0 0 13 8V7a.5.5 0 0 0-1 0v1c0 .274-.027.54-.08.799l.814.814zm-2.522 1.72A4 4 0 0 1 4 8V7a.5.5 0 0 0-1 0v1a5 5 0 0 0 4.5 4.975V15h-3a.5.5 0 0 0 0 1h7a.5.5 0 0 0 0-1h-3v-2.025a4.973 4.973 0 0 0 2.43-.923l-.718-.719zM11 7.88V3a3 3 0 0 0-5.842-.963L11 7.879zM5 6.12l4.486 4.486A3 3 0 0 1 5 8V6.121zm8.646 7.234l-12-12 .708-.708 12 12-.708.707z"/>
						</svg>
					</td>
				</tr>
				<tr key="led_Btn"><td><input type="checkbox" /></td>
					<td>
						<svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-lightning-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M11.251.068a.5.5 0 0 1 .227.58L9.677 6.5H13a.5.5 0 0 1 .364.843l-8 8.5a.5.5 0 0 1-.842-.49L6.323 9.5H3a.5.5 0 0 1-.364-.843l8-8.5a.5.5 0 0 1 .615-.09z"/></svg>
					</td>
				</tr>
				<tr key="wb_Btn"><td><input type="checkbox" /></td><td>WB</td></tr>
				<tr key="af_Btn"><td><input type="checkbox" /></td><td>AF</td></tr>
				<tr key="ev_Btn"><td><input type="checkbox" /></td><td>EV</td></tr>
				<tr key="el_Btn"><td><input type="checkbox" /></td><td>EL</td></tr>
				<tr key="zm_Btn"><td><input type="checkbox" /></td>
					<td>
						<svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-zoom-in" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
							<path fill-rule="evenodd" d="M6.5 12a5.5 5.5 0 1 0 0-11 5.5 5.5 0 0 0 0 11zM13 6.5a6.5 6.5 0 1 1-13 0 6.5 6.5 0 0 1 13 0z"/>
							<path d="M10.344 11.742c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1 6.538 6.538 0 0 1-1.398 1.4z"/>
							<path fill-rule="evenodd" d="M6.5 3a.5.5 0 0 1 .5.5V6h2.5a.5.5 0 0 1 0 1H7v2.5a.5.5 0 0 1-1 0V7H3.5a.5.5 0 0 1 0-1H6V3.5a.5.5 0 0 1 .5-.5z"/>
						</svg>
					</td>
				</tr>
				<tr key="stop_Btn"><td><input type="checkbox" /></td>
					<td>
						<svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-x-octagon-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
						  <path fill-rule="evenodd" d="M11.46.146A.5.5 0 0 0 11.107 0H4.893a.5.5 0 0 0-.353.146L.146 4.54A.5.5 0 0 0 0 4.893v6.214a.5.5 0 0 0 .146.353l4.394 4.394a.5.5 0 0 0 .353.146h6.214a.5.5 0 0 0 .353-.146l4.394-4.394a.5.5 0 0 0 .146-.353V4.893a.5.5 0 0 0-.146-.353L11.46.146zm-6.106 4.5a.5.5 0 1 0-.708.708L7.293 8l-2.647 2.646a.5.5 0 0 0 .708.708L8 8.707l2.646 2.647a.5.5 0 0 0 .708-.708L8.707 8l2.647-2.646a.5.5 0 0 0-.708-.708L8 7.293 5.354 4.646z"/>
						</svg>
					</td>
				</tr>
				<tr key="popout_Btn"><td><input type="checkbox" /></td>
					<td>
						<svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-arrow-up-right-square" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M14 1H2a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"/><path fill-rule="evenodd" d="M5.172 10.828a.5.5 0 0 0 .707 0l4.096-4.096V9.5a.5.5 0 1 0 1 0V5.525a.5.5 0 0 0-.5-.5H6.5a.5.5 0 0 0 0 1h2.768l-4.096 4.096a.5.5 0 0 0 0 .707z"/></svg>
					</td>
				</tr>
				<tr><td colspan="2"><input type="button" onclick="options.save();" value="OK" /></td></tr>
			</table>
		</div>
		<div class="row" style="width: fit-content">
			<div class="col-c">
				<div class="btn-group-vertical" role="group" aria-label="Button group" id="btn_bar">
					<div class="btn-group" role="group">
						<button id="cameraNo_Btn" type="button" class="btn btn-dark dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
							<svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-camera-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M10.5 8.5a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0z"/><path fill-rule="evenodd" d="M2 4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2h-1.172a2 2 0 0 1-1.414-.586l-.828-.828A2 2 0 0 0 9.172 2H6.828a2 2 0 0 0-1.414.586l-.828.828A2 2 0 0 1 3.172 4H2zm.5 2a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1zm9 2.5a3.5 3.5 0 1 1-7 0 3.5 3.5 0 0 1 7 0z"/></svg>
						</button>
						<div id="cameraList" class="dropdown-menu" aria-labelledby="cameraNo_Btn">
						</div>
					</div>
					<button id="mic_Btn" type="button" class="btn btn-dark" onclick="mic_toggle();" title="Mute" locale-tag-title="mute_sound">
						<svg xmlns="http://www.w3.org/2000/svg" id="mic_on_ico" width="16" height="16" fill="currentColor" class="bi bi-mic-fill" viewBox="0 0 16 16">
						  <path d="M5 3a3 3 0 0 1 6 0v5a3 3 0 0 1-6 0V3z"/><path fill-rule="evenodd" d="M3.5 6.5A.5.5 0 0 1 4 7v1a4 4 0 0 0 8 0V7a.5.5 0 0 1 1 0v1a5 5 0 0 1-4.5 4.975V15h3a.5.5 0 0 1 0 1h-7a.5.5 0 0 1 0-1h3v-2.025A5 5 0 0 1 3 8V7a.5.5 0 0 1 .5-.5z"/></svg>
						<svg xmlns="http://www.w3.org/2000/svg" id="mic_off_ico" width="16" height="16" fill="currentColor" class="bi bi-mic-mute-fill" viewBox="0 0 16 16">
						  <path fill-rule="evenodd" d="M12.734 9.613A4.995 4.995 0 0 0 13 8V7a.5.5 0 0 0-1 0v1c0 .274-.027.54-.08.799l.814.814zm-2.522 1.72A4 4 0 0 1 4 8V7a.5.5 0 0 0-1 0v1a5 5 0 0 0 4.5 4.975V15h-3a.5.5 0 0 0 0 1h7a.5.5 0 0 0 0-1h-3v-2.025a4.973 4.973 0 0 0 2.43-.923l-.718-.719zM11 7.88V3a3 3 0 0 0-5.842-.963L11 7.879zM5 6.12l4.486 4.486A3 3 0 0 1 5 8V6.121zm8.646 7.234l-12-12 .708-.708 12 12-.708.707z"/>
						</svg>
					</button>
					<button id="led_Btn" type="button" class="btn btn-dark" onclick="led_toggle();" title="(L)">
						<svg xmlns="http://www.w3.org/2000/svg" id="led_on_ico" width="16" height="16" fill="currentColor" class="bi bi-lightning-charge-fill" viewBox="0 0 16 16">
						  <path d="M11.251.068a.5.5 0 0 1 .227.58L9.677 6.5H13a.5.5 0 0 1 .364.843l-8 8.5a.5.5 0 0 1-.842-.49L6.323 9.5H3a.5.5 0 0 1-.364-.843l8-8.5a.5.5 0 0 1 .615-.09z"/>
						</svg>
						<svg xmlns="http://www.w3.org/2000/svg" id="led_off_ico" width="16" height="16" fill="currentColor" class="bi bi-lightning-charge" viewBox="0 0 16 16">
						  <path d="M11.251.068a.5.5 0 0 1 .227.58L9.677 6.5H13a.5.5 0 0 1 .364.843l-8 8.5a.5.5 0 0 1-.842-.49L6.323 9.5H3a.5.5 0 0 1-.364-.843l8-8.5a.5.5 0 0 1 .615-.09zM4.157 8.5H7a.5.5 0 0 1 .478.647L6.11 13.59l5.732-6.09H9a.5.5 0 0 1-.478-.647L9.89 2.41 4.157 8.5z"/>
						</svg>
					</button>

					<div class="btn-group" role="group">
						<button id="wb_Btn" type="button" class="btn btn-dark dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" range-option="">WB</button>
						<div class="dropdown-menu" aria-labelledby="wb_Btn">
							<button class="dropdown-item" onclick="set_wb_mode(0);" wb-option="" locale-tag="automatic">Auto</button>
							<button class="dropdown-item" onclick="wbl_toggle();" id="wbl_Btn">
								<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-lock" viewBox="0 0 16 16">
								  <path d="M8 1a2 2 0 0 1 2 2v4H6V3a2 2 0 0 1 2-2zm3 6V3a3 3 0 0 0-6 0v4a2 2 0 0 0-2 2v5a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2zM5 8h6a1 1 0 0 1 1 1v5a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V9a1 1 0 0 1 1-1z"/>
								</svg>
							</button>
							<div class="dropdown-divider"></div>
							<button class="dropdown-item" onclick="set_wb_mode(1);" wb-option="" locale-tag="wb_incandescent">0</button>
							<button class="dropdown-item" onclick="set_wb_mode(2);" wb-option="" locale-tag="wb_fluorescent_warm">1</button>
							<button class="dropdown-item" onclick="set_wb_mode(3);" wb-option="" locale-tag="wb_twilight">2</button>
							<button class="dropdown-item" onclick="set_wb_mode(4);" wb-option="" locale-tag="wb_fluorescent">3</button>
							<button class="dropdown-item" onclick="set_wb_mode(5);" wb-option="" locale-tag="wb_daylight">4</button>
							<button class="dropdown-item" onclick="set_wb_mode(6);" wb-option="" locale-tag="wb_daylight_cloudy">5</button>
							<button class="dropdown-item" onclick="set_wb_mode(7);" wb-option="" locale-tag="wb_shade">6</button>
							<button class="dropdown-item" onclick="setRangeControl(WB);" wb-option="" id="mwb_Btn" locale-tag="manual">Manual</button>
						</div>
					</div>

					<div class="btn-group" role="group">
						<button id="af_Btn" type="button" class="btn btn-dark dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" range-option="">AF</button>
						<div class="dropdown-menu" aria-labelledby="af_Btn">
							<button class="dropdown-item" href="#" onclick="auto_focus();" title="(F)">[AF]</button>
							<div class="dropdown-divider"></div>
							<button class="dropdown-item" href="#" onclick="set_focus_mode(0);" af-option="" locale-tag="af_normal">0</button>
							<button class="dropdown-item" href="#" onclick="set_focus_mode(1);" af-option="" locale-tag="af_macro">1</button>
							<button class="dropdown-item" href="#" onclick="set_focus_mode(2);" af-option="" locale-tag="af_continuous_video">2</button>
							<button class="dropdown-item" href="#" onclick="set_focus_mode(3);" af-option="" locale-tag="af_infinity">3</button>
							<button class="dropdown-item" href="#" onclick="setRangeControl(MF);" af-option="" id="mf_Btn" locale-tag="manual">Manual</button>
						</div>
					</div>

					<button id="ev_Btn" type="button" class="btn btn-dark" range-option="" onclick="setRangeControl(EV);" locale-tag-title="exposure_value" title="Exposure Value">EV</button>
					<button id="el_Btn" type="button" class="btn btn-dark" onclick="el_toggle();" locale-tag-title="exposure_lock" title="Exposure Lock">
						EL
						<svg xmlns="http://www.w3.org/2000/svg" id="el_on_ico" width="16" height="16" fill="currentColor" class="bi bi-lock" viewBox="0 0 16 16">
						  <path d="M8 1a2 2 0 0 1 2 2v4H6V3a2 2 0 0 1 2-2zm3 6V3a3 3 0 0 0-6 0v4a2 2 0 0 0-2 2v5a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2zM5 8h6a1 1 0 0 1 1 1v5a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V9a1 1 0 0 1 1-1z"/>
						</svg>
						<svg xmlns="http://www.w3.org/2000/svg" id="el_off_ico" width="16" height="16" fill="currentColor" class="bi bi-unlock" viewBox="0 0 16 16">
						  <path d="M11 1a2 2 0 0 0-2 2v4a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h5V3a3 3 0 0 1 6 0v4a.5.5 0 0 1-1 0V3a2 2 0 0 0-2-2zM3 8a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V9a1 1 0 0 0-1-1H3z"/>
						</svg>
					</button>

					<button id="zm_Btn" type="button" class="btn btn-dark" range-option="" onclick="setRangeControl(ZOOM);" title="Zoom">
						<svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-zoom-in" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
							<path fill-rule="evenodd" d="M6.5 12a5.5 5.5 0 1 0 0-11 5.5 5.5 0 0 0 0 11zM13 6.5a6.5 6.5 0 1 1-13 0 6.5 6.5 0 0 1 13 0z"/>
							<path d="M10.344 11.742c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1 6.538 6.538 0 0 1-1.398 1.4z"/>
							<path fill-rule="evenodd" d="M6.5 3a.5.5 0 0 1 .5.5V6h2.5a.5.5 0 0 1 0 1H7v2.5a.5.5 0 0 1-1 0V7H3.5a.5.5 0 0 1 0-1H6V3.5a.5.5 0 0 1 .5-.5z"/>
						</svg>
					</button>

					<button id="stop_Btn" type="button" class="btn btn-dark" onclick="want_stop();" locale-tag-title="stop" title="Stop">
						<svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-x-octagon-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
						  <path fill-rule="evenodd" d="M11.46.146A.5.5 0 0 0 11.107 0H4.893a.5.5 0 0 0-.353.146L.146 4.54A.5.5 0 0 0 0 4.893v6.214a.5.5 0 0 0 .146.353l4.394 4.394a.5.5 0 0 0 .353.146h6.214a.5.5 0 0 0 .353-.146l4.394-4.394a.5.5 0 0 0 .146-.353V4.893a.5.5 0 0 0-.146-.353L11.46.146zm-6.106 4.5a.5.5 0 1 0-.708.708L7.293 8l-2.647 2.646a.5.5 0 0 0 .708.708L8 8.707l2.646 2.647a.5.5 0 0 0 .708-.708L8.707 8l2.647-2.646a.5.5 0 0 0-.708-.708L8 7.293 5.354 4.646z"/>
						</svg>
					</button>

					<button id="popout_Btn" onclick="popout();" type="button" class="btn btn-dark">
						<svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-arrow-up-right-square" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M14 1H2a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"/><path fill-rule="evenodd" d="M5.172 10.828a.5.5 0 0 0 .707 0l4.096-4.096V9.5a.5.5 0 1 0 1 0V5.525a.5.5 0 0 0-.5-.5H6.5a.5.5 0 0 0 0 1h2.768l-4.096 4.096a.5.5 0 0 0 0 .707z"/></svg>
					</button>
				</div>
			</div>
			<div class="col-c">&nbsp;</div>
			<div class="col-c d-flex flex-column justify-content-center">
				<div class="row d-flex justify-content-center">
					<div class="range-cell">
						<a onclick="getRange(activeControl)[0].decrement(); return false;" type="button">
							<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-dash-circle" viewBox="0 0 16 16"><path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"/><path d="M4 8a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7A.5.5 0 0 1 4 8"/>
							</svg>
						</a>
						&nbsp;
						<a onclick="getRange(activeControl)[0].increment(); return false;" type="button">
							<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-plus-circle" viewBox="0 0 16 16"><path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"/><path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4"/>
							</svg>
						</a>
					</div>
				</div>
				<div class="row d-flex justify-content-center">
					<div class="range-cell">
						<input id="rangeControl" name="rangeControl" type="range" step="1" class="range-control" />
					</div>
				</div>
				<div class="row d-flex justify-content-center">
					<div class="range-cell">
						<input type="number" min="-100" max="9999" id="rangeInput" size="3" />
						<label id="rangeLabel" class="form-check-label" for="rangeInput" />
					</div>
				</div>
				<a onclick="hideRange(); poll(); return false;" class="range-close-x range-cell" type="button" locale-tag-title="close" title="Close">
					<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-x" viewBox="0 0 16 16"><path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708"/>
					</svg>
				</a>
			</div>
		</div><!-- row -->
<script src="assets/jquery-3.5.1.min.js"></script>
<script src="assets/bootstrap-4.5.3.bundle.min.js"></script>
<script src="assets/strings.js"></script>
<script type="text/javascript">
	var ajax_lock = false;
	var NONE = 256,
		ZOOM = 3,
		EV = 2,
		MF = 1,
		WB = 0;
	var activeControl = NONE;
	var cameraList;
	var RangeValue = function(value, min, max, nums, units) {
		this.min = min;
		this.max = max;
		this.range = max - min;
		this.value = value;
		this.nums = nums;
		this.tick = (nums ? (nums/10) : 1);
		this.units = units;
	}

	RangeValue.prototype.apply = function(value) {
		this.value = Math.min(Math.max(value, this.min), this.max)
	}

	RangeValue.prototype.percent = function() {
		return parseInt((this.value - this.min) * 100 / this.range);
	}

	RangeValue.prototype.toValue = function(percent) {
		return this.range * (percent / 100.0) + this.min
	}

	RangeValue.prototype.toFixed = function(precision) {
		const p = precision ? precision : this.nums;
		return this.value.toFixed(p);
	}

	RangeValue.prototype.increment = function() {
		$('#rangeInput').val(this.value + this.tick).trigger("paste");
	}

	RangeValue.prototype.decrement = function() {
		$('#rangeInput').val(this.value - this.tick).trigger("paste");
	}

	function popout() {
		window.open(document.URL,"popout",
			"top=" + window.screenTop + ",left=" + window.screenLeft
			+ ",width=320,height=320,location=0,status=0,toolbar=0,menubar=0,scrollbars=0");
	}

	function put(api) {
		if (ajax_lock) return;
		ajax_lock = true;
		$.ajax({
			url: api,
			type: 'PUT',
			timeout: 1000
		})
		.fail(onFail)
		.always(function() {
			ajax_lock = false;
		});
	}

	function put_and_poll(api, delay) {
		if (ajax_lock) return;
		ajax_lock = true;
		hideRange();
		$('#loading_ico').show();
		$.ajax({
			url: api,
			type: 'PUT',
			timeout: 1000,
			success: function(result) {
				do_poll(delay);
			}
		})
		.fail(onFail)
		.always(function() {
			ajax_lock = false;
		});
	}

	function put_range_value(range, api, value) {
		if (ajax_lock) return;
		if (!isFinite(value)) return;
		if (Math.abs(value - range.value) > 0.05) {
			range.apply(value);
			put(api + range.toFixed());
			$('#rangeControl').val(range.percent());
			$('#rangeInput').val(range.toFixed());
		}
	}

	$('#rangeInput').on("change paste", function(e) {
		var value = parseFloat(e.target.value);
		const [range, api] = getRange(activeControl);
		put_range_value(range, api, value);
	});

	$('#rangeControl').on("input", function(e) {
		const progress = $('#rangeControl').val();
		const [range, api] = getRange(activeControl);
		put_range_value(range, api, range.toValue(progress));
	});

	function showRange(range) {
		$('#rangeControl').val(range.percent());
		$('#rangeInput').val(range.toFixed());
		$('#rangeLabel').text(range.units)
		$('.range-cell').show();
		var r_options = $('[range-option]');
		r_options.removeClass('active');
		r_options.eq(activeControl).addClass('active');
	}

	function hideRange() {
		$('[range-option]').removeClass('active');
		$('.range-cell').hide();
		activeControl = NONE;
	}

	function setRangeControl(ctl) {
		if (activeControl == ctl) {
			hideRange();
			return;
		}

		const range = getRange(ctl)[0];
		if (range) {
			activeControl = ctl;
			showRange(range);
		}
		else {
			hideRange();
		}
	}

	function getRange(ctl) {
		switch(ctl) {
			case ZOOM: return [ zmRange, '/v3/camera/zoom/' ];
			case EV:   return [ evRange, '/v3/camera/ev/' ];
			case WB:   return [ wbRange, '/v2/camera/wb_level/' ];
			case MF:   return [ mfRange, '/v3/camera/mf/' ];
			default:   return [ null, null ];
		}
	}

	function auto_focus() {
		put_and_poll('/v1/camera/autofocus');
	}

	function set_focus_mode(value) {
		put_and_poll('/v1/camera/autofocus_mode/' + value);
	}

	function set_wb_mode(value) {
		put_and_poll('/v1/camera/wb_mode/' + value);
	}

	function mic_toggle() {
		put_and_poll('/v1/camera/mic_toggle');
	}

	function led_toggle() {
		put_and_poll('/v1/camera/torch_toggle');
	}

	function el_toggle() {
		put_and_poll('/v1/camera/el_toggle');
	}

	function wbl_toggle() {
		put_and_poll('/v1/camera/wbl_toggle');
	}

	function select_camera(num) {
		put_and_poll('/v1/camera/active/' + num, 1280);
	}

	function poll() {
		$.get('/v1/camera/info', function(result) {
			var cams = $('[cam-list]');
			cams.removeClass('active');
			cams.eq(result.active).addClass('active');
			$('#loading_ico').hide();

			if (result.led_on < 0) {
				$('#led_Btn').hide();
			}
			else {
				if (result.led_on) {
					$('#led_on_ico').show();
					$('#led_off_ico').hide();
				} else {
					$('#led_on_ico').hide();
					$('#led_off_ico').show();
				}
				$('#led_Btn').show();
			}

			if (result.wbMode < 0) {
				$('#wb_Btn').hide();
			}
			else {
				var wb_options = $('[wb-option]');
				wb_options.removeClass('active');
				wb_options.eq(result.wbMode).addClass('active');
				$('#wb_Btn').show();
			}

			if (result.wbLock < 0) {
				$('#wbl_Btn').hide();
			} else {
				if (result.wbLock) $('#wbl_Btn').addClass('active');
				else $('#wbl_Btn').removeClass('active');
				$('#wbl_Btn').show();
			}

			if (result.wbValue < 0) {
				$('#mwb_Btn').hide();
			} else {
				$('#mwb_Btn').show();
				wbRange = new RangeValue(result.wbValue, result.wbMin, result.wbMax, 0, '');
			}

			if (result.focusMode < 0)  {
				$('#af_Btn').hide();
			}
			else {
				var af_options = $('[af-option]');
				af_options.removeClass('active');
				af_options.eq(result.focusMode).addClass('active');
				$('#af_Btn').show();
			}

			if (result.mfValue < 0) {
				$('#mf_Btn').hide();
			} else {
				$('#mf_Btn').show();
				mfRange = new RangeValue(result.mfValue, result.mfMin, result.mfMax, 1, 'f');
			}

			if (result.zmValue < 0) {
				$('#zm_Btn').hide();
			} else {
				$('#zm_Btn').show();
				zmRange = new RangeValue(result.zmValue, result.zmMin, result.zmMax, 1, 'x');
			}

			if (result.evMin == 0 || result.evMax == 0 || result.evMin == result.evMax) {
				$('#ev_Btn').hide();
			} else {
				$('#ev_Btn').show();
				evRange = new RangeValue(result.evValue, result.evMin, result.evMax, 0, 'EV');
			}

			if (result.exposure_lock) {
				$('#el_on_ico').show();
				$('#el_off_ico').hide();
			} else {
				$('#el_on_ico').hide();
				$('#el_off_ico').show();
			}

			if (result.mute_sound == 1) {
				$('#mic_on_ico').hide();
				$('#mic_off_ico').show();
			} else if (result.mute_sound == 0) {
				$('#mic_on_ico').show();
				$('#mic_off_ico').hide();
			} else {
				$('#mic_Btn').hide();
			}
		}).fail(onFail).always(options.apply);
	}

	function battery_poll() {
		$.get('/v1/phone/battery_info', function(result) {
			var text = '';
			$('#battery_info').removeClass();
			if (result.level > 80) $('#battery_info').addClass('badge badge-success');
			else if ( result.level < 25 ) $('#battery_info').addClass('badge badge-danger');
			else if ( result.level < 50 ) $('#battery_info').addClass('badge badge-warning');
			else $('#battery_info').addClass('badge badge-info');

			text += result.level;
			if (result.amps != 0) {
				text += result.amps > 0 ? ' &#8673;' : ' &#8675;';
				$("#battery_info").attr('title', result.amps > 0 ? 'Charging' : 'Discharging');
			} else {
				$("#battery_info").attr('title', '');
			}
			$('#battery_value').html(text);
		}).fail(function() {
			$('#battery_info').removeClass();
			$('#battery_info').addClass('badge badge-danger');
			$("#battery_info").attr('title', 'Error');
			$('#battery_value').html('');
		});
		setTimeout(battery_poll, 60000);
	}

	function init() {
		onSize();
		$('#overlay-loading').show();
		if (window.name=='popout') $('#popout_Btn').hide();
		$.get('/v1/phone/name', function(result) {
			document.title = result;
			$('#title').text(result);
			$.get('/v1/camera/camera_list', function(result) {
				cameraList = result.split("\n");
				for (var i in cameraList) {
					(label = cameraList[i]) && $('#cameraList').append(
						'<a class="dropdown-item" href="#" cam-list="#" onclick="select_camera('+i+'); return false;">'+label+'</a>'
					);
				}
				$('#overlay-loading').hide();

				do_poll();
				battery_poll();
			});
		});
	}

	function do_poll(delay) { delay = delay || 700; setTimeout(poll, delay); }
	function do_reload(delay) { setTimeout(window.location.reload.bind(location), delay); }
	$(window).on("load", init);

	$(window).resize(function () {
		throttle(onSize, 10, "resize1");
	});

	$(document).on("keyup", function(e) {
		if (e.keyCode == 70) auto_focus();
		else if (e.keyCode == 76) led_toggle();
	});

	function onFail(xhr) {
		$('#loading_ico').hide();
		if (0) {}
		else if (xhr && xhr.status == 550) $('#overlay-get-pro').show();
		else if (xhr && xhr.status == 555) $('#overlay-stopped').show();
		else $('#overlay-offline').show();
	}

	function onSize() {
		var rc, ac;
		var btnBar = $("#btn_bar");
		if (window.innerHeight < (window.innerWidth*4/5)) {
			ac = "btn-group";
			rc = "btn-group-vertical";
			$("#rangeControl").removeClass("range-control");
		} else {
			rc = "btn-group";
			ac = "btn-group-vertical";
			$("#rangeControl").addClass("range-control");
		}
		if (btnBar.hasClass(rc)) { btnBar.removeClass(rc); btnBar.addClass(ac); }
	}

	function want_stop() {
		$("#modalLabel").text(strings["are_u_sure"]);
		$("#modalBody").text(strings["conn_stop"]);
		$("#modalDialog").attr('action', 'want_stop');
		$('#modalDialog').modal('show');
	}

	function video_inactive_info() {
		$("#modalLabel").text(strings["video_inactive"]);
		$("#modalBody").text(strings["video_inactive_sum"]);
		$("#modalDialog").attr('action', 'video_inactive_info');
		$('#modalDialog').modal('show');
	}

	function modal_confirm() {
		$('#modalDialog').modal('hide');
		var action = $("#modalDialog").attr('action');
		if (action == 'want_stop') {
			put_and_poll('/v1/stop');
		}
	}

	var throttle = (function(){
	  var timers = {};
	  return function (callback, ms, uniqueId) {
		if (!uniqueId) {
			console.log("error: missing uId");
			return;
		}
		if (timers[uniqueId]) {
		  clearTimeout (timers[uniqueId]);
		}
		timers[uniqueId] = setTimeout(callback, ms);
	  };
	})();

	var options = {
		enabled: function(opt) {
			return localStorage.getItem(opt) ? false : true;
		},
		set: function(opt, enable) {
			if (enable) localStorage.removeItem(opt); else localStorage.setItem(opt, 1);
		},
		apply: function() {
			var table = document.getElementById('options_table');
			for (var i = 0; i < table.rows.length; i++) {
				var row = table.rows[i];
				var key = row.getAttribute("key");
				if (!options.enabled(key)) {
					document.getElementById(key).style.display = 'none';
				}
			}
		},
		show: function() {
			var table = document.getElementById('options_table');
			for (var i = 0; i < table.rows.length; i++) {
				var row = table.rows[i];
				var key = row.getAttribute("key");
				row.children[0].children[0].checked = options.enabled(key);
			}
			$('#overlay-options').show();
		},
		save: function() {
			var table = document.getElementById('options_table');
			for (var i = 0; i < table.rows.length; i++) {
				var row = table.rows[i];
				var key = row.getAttribute("key");
				options.set(key, row.children[0].children[0].checked);
			}
			$('#overlay-options').hide();
			do_reload(0);
		},
	};
</script>
<div class="modal" id="modalDialog" tabindex="-1" aria-labelledby="modalLabel" aria-hidden="true">
  <div class="modal-dialog modal-sm modal-dialog-centered">
	<div class="modal-content">
	  <div class="modal-header">
		<h5 class="modal-title" id="modalLabel"></h5>
		<button type="button" class="close" data-dismiss="modal" aria-label="Close">
		  <span aria-hidden="true">&times;</span>
		</button>
	  </div>
	  <div class="modal-body" id="modalBody">
	  </div>
	  <div class="modal-footer">
		<button type="button" class="btn btn-secondary" data-dismiss="modal" locale-tag="cancel">Cancel</button>
		<button type="button" class="btn btn-primary" onclick="modal_confirm();">OK</button>
	  </div>
	</div>
  </div>
</div>
</body>
</html>
